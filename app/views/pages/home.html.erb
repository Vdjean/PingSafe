<div class="pingsafe-mobile-wrapper"
     data-controller="mapbox map-footer"
     data-mapbox-access-token-value="<%= ENV['MAPBOX_TOKEN'] %>"
     data-mapbox-pings-value="<%= @visible_pings.map { |p| { id: p.id, latitude: p.latitude, longitude: p.longitude, comment: p.comment, date: p.date, user_id: p.user_id, expires_at: (p.created_at + 15.minutes).iso8601, created_at: p.created_at.iso8601, blurred_photo_url: p.blurred_photo_url, address: p.formatted_address } }.to_json %>"
     data-mapbox-current-user-id-value="<%= current_user&.id %>">
<div id="map"
       class="pingsafe-map-container pingsafe-map-tall"
       data-map-footer-target="map"
       data-mapbox-target="container">
  </div>

  <div class="pingsafe-lower-panel">
    <div class="pingsafe-content">

<div class="pingsafe-card-grid pingsafe-card-grid-horizontal">
  <%= link_to new_ping_path(camera: true), class: 'pingsafe-action-card pingsafe-card-square pingsafe-card-primary' do %>
    <div class="pingsafe-card-icon pingsafe-icon-primary">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m22 8-6 4 6 4V8Z"/>
        <rect width="14" height="12" x="2" y="6" rx="2" ry="2"/>
      </svg>
    </div>
    <div class="pingsafe-card-content">
      <h3 class="pingsafe-card-title">Pinger</h3>
      <p class="pingsafe-card-description">Take a picture</p>
    </div>
  <% end %>

  <%= link_to new_ping_path, class: 'pingsafe-action-card pingsafe-card-square pingsafe-card-secondary' do %>
    <div class="pingsafe-card-icon pingsafe-icon-secondary">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
      </svg>
    </div>
    <div class="pingsafe-card-content">
      <h3 class="pingsafe-card-title">Details</h3>
      <p class="pingsafe-card-description">Fill the form</p>
    </div>
  <% end %>
</div>
 <%= render "shared/alert" %>
</div>

<div class="pingsafe-footer" data-map-footer-target="footer">
  <%= render "shared/footer" %>
</div>

<div class="ping-modal" data-mapbox-target="modal">
  <div class="ping-modal-overlay" data-action="click->mapbox#closeModal"></div>
  <div class="ping-modal-content">
    <button class="ping-modal-close" data-action="click->mapbox#closeModal">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>

    <div class="ping-modal-timer">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12 6 12 12 16 14"/>
      </svg>
      <span data-mapbox-target="timerText">Il y a 3 min</span>
    </div>

    <div class="ping-modal-photo" data-mapbox-target="modalPhoto">
      <img src="" alt="Photo" data-mapbox-target="photoImg">
      <div class="ping-modal-photo-placeholder" data-mapbox-target="photoPlaceholder">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <circle cx="8.5" cy="8.5" r="1.5"/>
          <polyline points="21 15 16 10 5 21"/>
        </svg>
        <span>Pas de photo</span>
      </div>
    </div>

    <div class="ping-modal-tags" data-mapbox-target="tagsContainer">
      <span class="ping-tag ping-tag-persons" data-mapbox-target="tagPersons">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
        <span data-mapbox-target="personsText">2 individus</span>
      </span>
      <span class="ping-tag ping-tag-sign" data-mapbox-target="tagSign">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
          <path d="M3 6h18"/>
          <path d="M16 10a4 4 0 0 1-8 0"/>
        </svg>
        <span data-mapbox-target="signText">Casquette rouge</span>
      </span>
    </div>

    <div class="ping-modal-comment" data-mapbox-target="modalComment">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
      </svg>
      <p data-mapbox-target="commentText">"Ils etaient pres du distributeur..."</p>
    </div>

    <div class="ping-modal-address" data-mapbox-target="modalAddress">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
        <circle cx="12" cy="10" r="3"/>
      </svg>
      <span data-mapbox-target="addressText"></span>
    </div>
  </div>
</div>
</div>
